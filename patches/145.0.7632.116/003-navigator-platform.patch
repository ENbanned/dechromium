From d9833b65ac14aea5cbfae94fe30d449c4c405fe6 Mon Sep 17 00:00:00 2001
From: ENbanned <nik.skvortsov2007@gmail.com>
Date: Thu, 26 Feb 2026 10:29:36 +0000
Subject: [PATCH 03/11] 003-navigator-platform

---
 .../blink/renderer/core/execution_context/navigator_base.cc | 6 ++++++
 third_party/blink/renderer/core/frame/navigator_id.cc       | 6 ++++++
 2 files changed, 12 insertions(+)

diff --git a/third_party/blink/renderer/core/execution_context/navigator_base.cc b/third_party/blink/renderer/core/execution_context/navigator_base.cc
index d08b96066d76f..089c02d0339b2 100644
--- a/third_party/blink/renderer/core/execution_context/navigator_base.cc
+++ b/third_party/blink/renderer/core/execution_context/navigator_base.cc
@@ -4,6 +4,9 @@
 
 #include "third_party/blink/renderer/core/execution_context/navigator_base.h"
 
+#include "base/command_line.h"
+#include "third_party/blink/public/common/switches.h"
+
 #include "base/feature_list.h"
 #include "build/build_config.h"
 #include "third_party/blink/public/common/features.h"
@@ -51,6 +54,9 @@ String NavigatorBase::userAgent() const {
 }
 
 String NavigatorBase::platform() const {
+  const auto& cmd = *base::CommandLine::ForCurrentProcess();
+  if (cmd.HasSwitch(blink::switches::kAspectPlatform))
+    return String(cmd.GetSwitchValueASCII(blink::switches::kAspectPlatform));
 #if BUILDFLAG(IS_ANDROID)
   ExecutionContext* execution_context = GetExecutionContext();
 
diff --git a/third_party/blink/renderer/core/frame/navigator_id.cc b/third_party/blink/renderer/core/frame/navigator_id.cc
index 50a1727f8dbd5..128f8d1fe5cb1 100644
--- a/third_party/blink/renderer/core/frame/navigator_id.cc
+++ b/third_party/blink/renderer/core/frame/navigator_id.cc
@@ -31,6 +31,9 @@
 
 #include "third_party/blink/renderer/core/frame/navigator_id.h"
 
+#include "base/command_line.h"
+#include "third_party/blink/public/common/switches.h"
+
 #include "base/feature_list.h"
 #include "build/build_config.h"
 #include "third_party/blink/public/common/features.h"
@@ -59,6 +62,9 @@ String NavigatorID::appVersion() {
 }
 
 String NavigatorID::platform() const {
+  const auto& cmd = *base::CommandLine::ForCurrentProcess();
+  if (cmd.HasSwitch(blink::switches::kAspectPlatform))
+    return String(cmd.GetSwitchValueASCII(blink::switches::kAspectPlatform));
 #if BUILDFLAG(IS_MAC)
   // Match Safari and Mozilla on Mac x86.
   return "MacIntel";
-- 
2.39.5

